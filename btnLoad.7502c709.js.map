{"mappings":"gkBAMA,MAAMA,EAAaC,SAASC,cAAc,gBACpCC,EAAUF,SAASC,cAAc,YACjCE,EAAcH,SAASC,cAAc,cACrCG,EAAkBJ,SAASC,cAAc,kBAE/C,IAAII,EAAQ,GACRC,EAAO,EACPC,EAAa,EAsGjB,SAASC,EAAcC,GACnB,MAAMC,EAAgBD,EACjBE,KACG,EAACC,GACGA,EAAEC,cACFA,EAAaC,aACbA,EAAYC,KACZA,EAAIC,MACJA,EAAKC,MACLA,EAAKC,SACLA,EAAQC,UACRA,KAEO,oDAC0BN,wDACCD,sCAClBE,WAAsBC,yJAGXC,4HAGAC,+HAGGC,gIAGCC,sHAQtCC,KAAK,IAEVlB,EAAQmB,mBAAmB,YAAaX,E,CAzI5CX,EAAWuB,iBAAiB,UAG5BC,eAA4BC,GAUxB,GATAA,EAAEC,iBAEFnB,EAAO,EACPD,EAAQmB,EAAEE,cAAcC,YAAYC,MAAMC,OAC1C3B,EAAQ4B,UAAY,GAEpB3B,EAAY4B,UAAUC,IAAI,aAC1B5B,EAAgB2B,UAAUC,IAAI,aAEhB,KAAV3B,EAEA,YAkIJ4B,EAAAC,GAASC,OAAOC,QAAQ,+BA9GxB,IACI,MACMC,SADe,EAAAC,EAAAC,UAASlC,EAAOC,EAtC7B,KAuCekC,KAIvB,GAHAjC,EAAa8B,EAAQI,KAAKC,OAGA,IAAtBL,EAAQM,UA4GhBV,EAAAC,GAASC,OAAOC,QACZ,kEA3GO,CACH5B,EAAc6B,EAAQI,MAgGlC,SAA4BJ,GACxBJ,EAAAC,GAASC,OAAOS,QAAQ,oBAAoBP,EAAQM,oB,CAhG5CE,CAAmBR,GACI,IAAIJ,EAAAa,GAAJ,CAAmB,cAAcC,S,CAGxDV,EAAQM,UAnDJ,IAoDJxC,EAAY4B,UAAUiB,OAAO,aAyGrCC,OAAOC,SAAS,CACZC,IAAK,EACLC,SAAU,U,CAvGZ,MAAOC,GACLpB,EAAAC,GAASC,OAAOC,QAAQ,+B,KAtDhCjC,EAAYmB,iBAAiB,SA0D7BC,iBACIjB,GAAQ,EAiBR,IACI,MACM+B,SADe,EAAAC,EAAAC,UAASlC,EAAOC,EAhF7B,KAiFekC,KAEjBG,EAAYN,EAAQM,UAC1BpC,GAAc8B,EAAQI,KAAKC,OAG3BlC,EAAc6B,EAAQI,MACC,IAAIR,EAAAa,GAAJ,CAAmB,cAAcC,UAEpDxC,IAAeoC,IACfxC,EAAY4B,UAAUC,IAAI,aAC1B5B,EAAgB2B,UAAUiB,OAAO,cAuE7C,WACI,MAAQM,OAAQC,GAAevD,SAC1BC,cAAc,YACduD,kBAAkBC,wBAEvBR,OAAOC,SAAS,CACZC,IAAkB,EAAbI,EACLH,SAAU,U,CA3EVM,E,CACF,MAAOL,GACLpB,EAAAC,GAASC,OAAOC,QAAQ,+B","sources":["src/btnLoad.js"],"sourcesContent":["import \"./css/styles.css\";\nimport { fetchImg } from \"./js/fetchImg\";\nimport Notiflix from \"notiflix\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst searchForm = document.querySelector(\"#search-form\");\nconst gallery = document.querySelector(\".gallery\");\nconst loadMoreBtn = document.querySelector(\".load-more\");\nconst endOfSearchText = document.querySelector(\".gallery__text\");\n\nlet query = \"\";\nlet page = 1;\nlet loadedHits = 0;\nconst perPage = 40;\n\nsearchForm.addEventListener(\"submit\", onSearchForm);\nloadMoreBtn.addEventListener(\"click\", onLoadMoreBtn);\n\nasync function onSearchForm(e) {\n    e.preventDefault();\n\n    page = 1;\n    query = e.currentTarget.searchQuery.value.trim();\n    gallery.innerHTML = \"\";\n\n    loadMoreBtn.classList.add(\"is-hidden\");\n    endOfSearchText.classList.add(\"is-hidden\");\n\n    if (query === \"\") {\n        alertEmptySearch();\n        return;\n    }\n\n    // fetchImg(query, page, perPage)\n    //     .then(({data}) => {\n    //         if (data.totalHits === 0) {\n    //             alertNoImagesFound();\n    //         } else {\n    //             renderGallery(data.hits);\n    //             alertImagesToFound(data);\n    //             simpleLightBox = new SimpleLightbox('.gallery a').refresh();\n    //         }\n\n    //         if (data.totalHits > perPage) {\n    //             loadMoreBtn.classList.remove('is-hidden');\n    //         }\n    //     }\n    // )\n    //     .catch(error => console.log(error));\n\n    try {\n        const object = await fetchImg(query, page, perPage);\n        const objData = object.data;\n        loadedHits = objData.hits.length;\n        // console.log('first', loadedHits)\n\n        if (objData.totalHits === 0) {\n            alertNoImagesFound();\n        } else {\n            renderGallery(objData.hits);\n            alertImagesToFound(objData);\n            const simpleLightBox = new SimpleLightbox(\".gallery a\").refresh();\n        }\n\n        if (objData.totalHits > perPage) {\n            loadMoreBtn.classList.remove(\"is-hidden\");\n        }\n\n        onScroll();\n    } catch (error) {\n        Notiflix.Notify.failure(\"Ooops...Something goes wrong\");\n    }\n}\n\nasync function onLoadMoreBtn() {\n    page += 1;\n\n    // fetchImg(query, page, perPage)\n    //     .then(({ data }) => {\n    //         const totalPages = Math.ceil(data.totalHits / perPage);\n\n    //         if (page > totalPages) {\n    //             loadMoreBtn.classList.add('is-hidden');\n    //             alertEndOfSearch();\n    //         } else {\n    //             renderGallery(data.hits);\n    //             simpleLightbox = new SimpleLightbox('.gallery a').refresh();\n    //         }\n\n    //     })\n    //     .catch(error => console.log(error));\n\n    try {\n        const object = await fetchImg(query, page, perPage);\n        const objData = object.data;\n        // const totalPages = Math.ceil(objData.totalHits / perPage);\n        const totalHits = objData.totalHits;\n        loadedHits += objData.hits.length;\n        // console.log('second', loadedHits)\n\n        renderGallery(objData.hits);\n        const simpleLightbox = new SimpleLightbox(\".gallery a\").refresh();\n\n        if (loadedHits === totalHits) {\n            loadMoreBtn.classList.add(\"is-hidden\");\n            endOfSearchText.classList.remove(\"is-hidden\");\n        }\n\n        onScrollMore();\n    } catch (error) {\n        Notiflix.Notify.failure(\"Ooops...Something goes wrong\");\n    }\n}\n\nfunction renderGallery(images) {\n    const galleryMarkup = images\n        .map(\n            ({\n                id,\n                largeImageURL,\n                webformatURL,\n                tags,\n                likes,\n                views,\n                comments,\n                downloads\n            }) => {\n                return `\n                <a class=\"gallery__link\" href=\"${largeImageURL}\">\n                    <div class=\"photo-card\" id=\"${id}\">\n                    <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n                    <div class=\"info\">\n                        <p class=\"info-item\">\n                            <b>Likes</b> ${likes}\n                        </p>\n                        <p class=\"info-item\">\n                            <b>Views</b> ${views}\n                        </p>\n                        <p class=\"info-item\">\n                            <b>Comments</b> ${comments}\n                        </p>\n                        <p class=\"info-item\">\n                            <b>Downloads</b> ${downloads}\n                        </p>\n                    </div>\n                </div>\n                </a>\n      `;\n            }\n        )\n        .join(\"\");\n\n    gallery.insertAdjacentHTML(\"beforeend\", galleryMarkup);\n}\n\nfunction alertImagesToFound(objData) {\n    Notiflix.Notify.success(`Hooray! We found ${objData.totalHits} images.`);\n}\n\nfunction alertEmptySearch() {\n    Notiflix.Notify.failure(\"This field cannot be empty!\");\n}\n\nfunction alertNoImagesFound() {\n    Notiflix.Notify.failure(\n        \"No images were found for this request, try something else.\"\n    );\n}\n\nfunction onScroll() {\n    window.scrollBy({\n        top: 0,\n        behavior: \"smooth\"\n    });\n}\n\nfunction onScrollMore() {\n    const { height: cardHeight } = document\n        .querySelector(\".gallery\")\n        .firstElementChild.getBoundingClientRect();\n\n    window.scrollBy({\n        top: cardHeight * 2,\n        behavior: \"smooth\"\n    });\n}\n"],"names":["$918a093cc4c54a5f$var$searchForm","document","querySelector","$918a093cc4c54a5f$var$gallery","$918a093cc4c54a5f$var$loadMoreBtn","$918a093cc4c54a5f$var$endOfSearchText","$918a093cc4c54a5f$var$query","$918a093cc4c54a5f$var$page","$918a093cc4c54a5f$var$loadedHits","$918a093cc4c54a5f$var$renderGallery","images","galleryMarkup","map","id","largeImageURL","webformatURL","tags","likes","views","comments","downloads","join","insertAdjacentHTML","addEventListener","async","e","preventDefault","currentTarget","searchQuery","value","trim","innerHTML","classList","add","$parcel$interopDefault","$7Y9D8","Notify","failure","objData","$dOcJw","fetchImg","data","hits","length","totalHits","success","$918a093cc4c54a5f$var$alertImagesToFound","$fZKcF","refresh","remove","window","scrollBy","top","behavior","error","height","cardHeight","firstElementChild","getBoundingClientRect","$918a093cc4c54a5f$var$onScrollMore"],"version":3,"file":"btnLoad.7502c709.js.map"}